{"componentChunkName":"component---src-pages-examples-json-json-content-parent-file-id-jsx","path":"/examples/json/662e8bf8-fcf5-55cc-82a1-3be05db89f86/","result":{"data":{"jsonContent":{"id":"fd6a08ae-d714-5c1f-8a05-2f327a599281","content":"CREATE CATALOG hive_tudou WITH (\r\n    'type' = 'hive',\r\n    'default-database' = 'tudou',\r\n    'hive-conf-dir' = '/opt/dtstack/hive/conf'\r\n    ,'hadoop-conf-dir' = '/opt/dtstack/hadoop-2.7.6/etc/hadoop'\r\n);\r\n\r\nCREATE TABLE source\r\n(\r\n    id        INT,\r\n    PROCTIME AS PROCTIME()\r\n) WITH (\r\n      'connector' = 'kafka-x'\r\n      ,'topic' = 'tudou'\r\n      ,'properties.bootstrap.servers' = 'ip:9092'\r\n      ,'scan.startup.mode' = 'latest-offset'\r\n      ,'value.format' = 'json'\r\n      );\r\n\r\nCREATE TABLE sink\r\n(\r\n    id          int,\r\n    user_id     int,\r\n    name        varchar\r\n    , PRIMARY KEY (id) NOT ENFORCED  -- 如果定义了，则根据该字段更新。否则追加\r\n) WITH (\r\n      'connector' = 'stream-x',\r\n      'print' = 'true'\r\n      );\r\n\r\ncreate\r\nTEMPORARY view view_out\r\n  as\r\nselect u.id\r\n     , s.user_id\r\n     , s.name\r\nfrom source u\r\n         left join hive_tudou.tudou.kudu_parquet\r\n    /*+ OPTIONS('streaming-source.enable'='true',               --SQL Hints方式，需要在confProp中配置table.dynamic-table-options.enabled=true\r\n        'streaming-source.partition.include' = 'latest',\r\n        'streaming-source.monitor-interval' = '1 h',\r\n        'streaming-source.partition-order' = 'partition-name') */\r\n    FOR SYSTEM_TIME AS OF u.PROCTIME AS s\r\n                   on u.id = s.id;\r\n\r\ninsert into sink\r\nselect *\r\nfrom view_out;\r\n"}},"pageContext":{"id":"fd6a08ae-d714-5c1f-8a05-2f327a599281","parent__id":"662e8bf8-fcf5-55cc-82a1-3be05db89f86","__params":{"parent__id":"662e8bf8-fcf5-55cc-82a1-3be05db89f86"}}},"staticQueryHashes":["1197112220","1410458087","527733040","63159454"]}