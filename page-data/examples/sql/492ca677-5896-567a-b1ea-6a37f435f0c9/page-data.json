{"componentChunkName":"component---src-pages-examples-sql-json-content-parent-file-id-jsx","path":"/examples/sql/492ca677-5896-567a-b1ea-6a37f435f0c9/","result":{"data":{"jsonContent":{"id":"3419197f-38f1-5829-a26c-37d394e12d52","content":"CREATE CATALOG hive_tudou WITH (\n    'type' = 'hive',\n    'default-database' = 'tudou',\n    'hive-conf-dir' = '/opt/dtstack/hive/conf'\n    ,'hadoop-conf-dir' = '/opt/dtstack/hadoop-2.7.6/etc/hadoop'\n);\n\nCREATE TABLE source\n(\n    id        INT,\n    PROCTIME AS PROCTIME()\n) WITH (\n      'connector' = 'kafka-x'\n      ,'topic' = 'tudou'\n      ,'properties.bootstrap.servers' = 'ip:9092'\n      ,'scan.startup.mode' = 'latest-offset'\n      ,'value.format' = 'json'\n      );\n\nCREATE TABLE sink\n(\n    id          int,\n    user_id     int,\n    name        varchar\n    , PRIMARY KEY (id) NOT ENFORCED  -- 如果定义了，则根据该字段更新。否则追加\n) WITH (\n      'connector' = 'stream-x',\n      'print' = 'true'\n      );\n\ncreate\nTEMPORARY view view_out\n  as\nselect u.id\n     , s.user_id\n     , s.name\nfrom source u\n         left join hive_tudou.tudou.kudu_parquet\n    /*+ OPTIONS('streaming-source.enable'='true',               --SQL Hints方式，需要在confProp中配置table.dynamic-table-options.enabled=true\n        'streaming-source.partition.include' = 'latest',\n        'streaming-source.monitor-interval' = '1 h',\n        'streaming-source.partition-order' = 'partition-name') */\n    FOR SYSTEM_TIME AS OF u.PROCTIME AS s\n                   on u.id = s.id;\n\ninsert into sink\nselect *\nfrom view_out;\n"}},"pageContext":{"id":"3419197f-38f1-5829-a26c-37d394e12d52","parent__id":"492ca677-5896-567a-b1ea-6a37f435f0c9","__params":{"parent__id":"492ca677-5896-567a-b1ea-6a37f435f0c9"}}},"staticQueryHashes":["1197112220","1410458087","527733040","63159454"]}