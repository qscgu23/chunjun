{"componentChunkName":"component---src-pages-examples-sql-json-content-parent-file-id-jsx","path":"/examples/sql/b4afde5e-2e79-5548-b686-5cf56b5f1217/","result":{"data":{"jsonContent":{"id":"6a73e488-fe69-5089-bc2d-012e0c9f5471","content":"-- {\"id\":1651,\"name\":\"james\",\"money\":293.899778,\"dateone\":\"2020-07-30 10:08:22\",\"age\":\"33\",\"datethree\":\"2020-07-30 10:08:22.123\",\"datesix\":\"2020-07-30 10:08:22.123456\",\"datenigth\":\"2020-07-30 10:08:22.123456789\",\"dtdate\":\"2020-07-30\",\"dttime\":\"11:08:22\"}\r\nCREATE TABLE source\r\n(\r\n    id        INT\r\n    , name      STRING\r\n    , money     decimal\r\n    , dateone   timestamp\r\n    , age       bigint\r\n    , datethree timestamp\r\n    , datesix   timestamp(6)\r\n    , datenigth timestamp(9)\r\n    , dtdate    date\r\n    , dttime    time\r\n    , PROCTIME AS PROCTIME()\r\n) WITH (\r\n      -- 'connector' = 'stream-x'\r\n\r\n      'connector' = 'kafka-x'\r\n      ,'topic' = 'da'\r\n      ,'properties.bootstrap.servers' = 'kudu1:9092'\r\n      ,'properties.group.id' = 'luna_g'\r\n      -- ,'scan.startup.mode' = 'earliest-offset'\r\n      ,'format' = 'json'\r\n      ,'json.timestamp-format.standard' = 'SQL'\r\n      );\r\n\r\n\r\nCREATE TABLE side\r\n(\r\n    id        INT\r\n    , name      STRING\r\n    , money     decimal\r\n    , dateone   timestamp\r\n    , age       bigint\r\n    , datethree timestamp\r\n    , datesix   timestamp(6)\r\n    , datenigth timestamp(9)\r\n    , dtdate    date\r\n    , dttime    time\r\n\r\n    , afloat    float\r\n    , adouble   double\r\n    , aboolean  BOOLEAN\r\n    , abigint   BIGINT\r\n    , atinyint  TINYINT\r\n    , avarchar  varchar\r\n    , asmallint SMALLINT\r\n    -- , primary key (id,name) NOT ENFORCED -- 这里的pk，并不会作为查询redis的主键，所以作为维表可不写。是通过select中的join条件作为主键\r\n) WITH (\r\n      'connector' = 'redis-x' --必填\r\n      ,'url' = 'localhost:6379' --必填，格式ip:port[,ip:port]\r\n      ,'table-name' = 'cx' --必填\r\n      ,'password' = '123456' -- 密码 无默认，非必填项\r\n      ,'redis-type' = '1' -- redis模式（1 单机，2 哨兵， 3 集群），默认：1\r\n      ,'master-name' = 'lala' -- 主节点名称（哨兵模式下为必填项）\r\n      ,'database' = '0' -- redis 的数据库地址，默认：0\r\n\r\n      ,'timeout' = '10000' -- 连接超时时间，默认：10000毫秒\r\n      ,'max.total' = '5' -- 最大连接数 ，默认：8\r\n      ,'max.idle' = '5' -- 最大空闲连接数，默认：8\r\n      ,'min.idle' = '0' -- 最小空闲连接数 ，默认：0\r\n\r\n      ,'lookup.cache-type' = 'all' -- 维表缓存类型(NONE、LRU、ALL)，默认LRU\r\n      ,'lookup.cache-period' = '4600000' -- ALL维表每隔多久加载一次数据，默认3600000毫秒\r\n      ,'lookup.cache.max-rows' = '20000' -- lru维表缓存数据的条数，默认10000条\r\n      ,'lookup.cache.ttl' = '700000' -- lru维表缓存数据的时间，默认60000毫秒\r\n      ,'lookup.fetch-size' = '2000' -- ALL维表每次从数据库加载的条数，默认1000条\r\n      ,'lookup.async-timeout' = '30000' -- lru维表缓访问超时时间，默认10000毫秒，暂时没用到\r\n      ,'lookup.parallelism' = '3' -- 维表并行度，默认null\r\n      );\r\n\r\n-- 维表数据\r\n-- 127.0.0.1:6379> HGETALL cx_1651\r\n--  1) \"dttime\"\r\n--  2) \"14:11:18\"\r\n--  3) \"adouble\"\r\n--  4) \"3807.67\"\r\n--  5) \"dtdate\"\r\n--  6) \"2021-06-22\"\r\n--  7) \"aboolean\"\r\n--  8) \"true\"\r\n--  9) \"datenigth\"\r\n-- 10) \"2021-06-22 06:11:18.478\"\r\n-- 11) \"afloat\"\r\n-- 12) \"7271.44\"\r\n-- 13) \"asmallint\"\r\n-- 14) \"7821\"\r\n-- 15) \"avarchar\"\r\n-- 16) \"h1\"\r\n-- 17) \"datesix\"\r\n-- 18) \"2021-06-22 06:11:18.478\"\r\n-- 19) \"money\"\r\n-- 20) \"3059\"\r\n\r\nCREATE TABLE sink\r\n(\r\n    id         INT\r\n    , name       STRING\r\n    , money      decimal\r\n    , dateone    timestamp\r\n    , age        bigint\r\n    , datethree  timestamp\r\n    , datesix    timestamp(6)\r\n    , datenigth  timestamp(9)\r\n    , dtdate     date\r\n    , dttime     time\r\n\r\n    , aid        INT\r\n    , aname      STRING\r\n    , amoney     decimal\r\n    , adateone   timestamp\r\n    , aage       bigint\r\n    , adatethree timestamp\r\n    , adatesix   timestamp(6)\r\n    , adatenigth timestamp(9)\r\n    , adtdate    date\r\n    , adttime    time\r\n\r\n    , afloat    float\r\n    , adouble   double\r\n    , aboolean  BOOLEAN\r\n    , abigint   BIGINT\r\n    , atinyint  TINYINT\r\n    , avarchar  varchar\r\n    , asmallint SMALLINT\r\n    -- , primary key (id, name) NOT ENFORCED\r\n) WITH (\r\n      'connector' = 'stream-x'\r\n      );\r\n\r\n\r\nINSERT INTO sink\r\nSELECT\r\n    u.id\r\n     , u.name\r\n     , u.money\r\n     , u.dateone\r\n     , u.age\r\n     , u.datethree\r\n     , u.datesix\r\n     , u.datenigth\r\n     , u.dtdate\r\n     , u.dttime\r\n\r\n     , s.id        as aid\r\n     , s.name      as aname\r\n     , s.money     as amoney\r\n     , s.dateone   as adateone\r\n     , s.age       as aage\r\n     , s.datethree as adatethree\r\n     , s.datesix   as adatesix\r\n     , s.datenigth as adatenigth\r\n     , s.dtdate    as adtdate\r\n     , s.dttime    as adttime\r\n\r\n     , s.afloat\r\n     , s.adouble\r\n     , s.aboolean\r\n     , s.abigint\r\n     , s.atinyint\r\n     , s.avarchar\r\n     , s.asmallint\r\nfrom source u\r\n         left join side FOR SYSTEM_TIME AS OF u.PROCTIME AS s\r\n                   on u.id = s.id;\r\n"}},"pageContext":{"id":"6a73e488-fe69-5089-bc2d-012e0c9f5471","parent__id":"b4afde5e-2e79-5548-b686-5cf56b5f1217","__params":{"parent__id":"b4afde5e-2e79-5548-b686-5cf56b5f1217"}}},"staticQueryHashes":["1197112220","1410458087","527733040","63159454"]}